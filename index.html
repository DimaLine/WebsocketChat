<!DOCTYPE html>
<html>
<body>
<h1>Chat</h1>
<div id="chat"></div>
<input id="msg" type="text">
<style>
input { border: 1px solid green; }
</style>
<script>

  const socket = new WebSocket('ws://127.0.0.1/chat');

  socket.onopen = () => {
    writeLine('connected');
  };

  socket.onclose = () => {
    writeLine('closed');
  };

  socket.onmessage = (event) => {
    writeLine(event.data);
  };

  const chat = document.getElementById('chat');
  const msg = document.getElementById('msg');
  msg.focus();

  msg.addEventListener('keydown', (event) => {
    if (event.keyCode === 13) {
      const s = msg.value;
      msg.value = '';
      writeLine(s);
      socket.send(s);
    }
  });

  const writeLine = (text) => {
    const line = document.createElement('div');
    line.innerHTML = '<p>' + text + '</p>';
    chat.appendChild(line);
  };

</script>
</body>
</html>
